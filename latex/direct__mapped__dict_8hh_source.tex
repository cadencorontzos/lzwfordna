\hypertarget{direct__mapped__dict_8hh_source}{}\doxysection{direct\+\_\+mapped\+\_\+dict.\+hh}
\label{direct__mapped__dict_8hh_source}\index{dictionary/direct\_mapped\_dict.hh@{dictionary/direct\_mapped\_dict.hh}}
\mbox{\hyperlink{direct__mapped__dict_8hh}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{dictionary_8hh}{dictionary.hh}}"{}}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#include <climits>}}
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <unordered\_map>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <x86intrin.h>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{comment}{// indexes for starting strings of length 1}}
\DoxyCodeLine{10 \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{direct__mapped__dict_8hh_af8f9eb4fcbbe1efd8b9cd5dc2929d894}{INDEX\_OF\_A}} = 0;}
\DoxyCodeLine{11 \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{direct__mapped__dict_8hh_a766afabeccd2c5c829795a29dd11025f}{INDEX\_OF\_C}} = 1;}
\DoxyCodeLine{12 \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{direct__mapped__dict_8hh_a1ff38b8c2b87aee43fb85456a2acde5f}{INDEX\_OF\_T}} = 2;}
\DoxyCodeLine{13 \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{direct__mapped__dict_8hh_a6f11125b1391df67936cb4e5d60c4ed2}{INDEX\_OF\_G}} = 3;}
\DoxyCodeLine{14 }
\DoxyCodeLine{15 \textcolor{keyword}{const} \textcolor{keywordtype}{bool} \mbox{\hyperlink{direct__mapped__dict_8hh_a41eb8ff724e2179b96c314a1fbd010d2}{BINARY\_SEARCH}} = \textcolor{keyword}{false};}
\DoxyCodeLine{16 \textcolor{keyword}{constexpr} uint8\_t \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}} = 15;}
\DoxyCodeLine{17 \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}} = 7;}
\DoxyCodeLine{18 \textcolor{keyword}{typedef} uint16\_t \mbox{\hyperlink{direct__mapped__dict_8hh_ac1be50354aea7190e5415d85286e6bfe}{codeword\_type}};}
\DoxyCodeLine{19 \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{direct__mapped__dict_8hh_af0a2638c9dc062f0b82810fc6c8d5e0f}{CODEWORD\_SIZE}} = \textcolor{keyword}{sizeof}(\mbox{\hyperlink{direct__mapped__dict_8hh_ac1be50354aea7190e5415d85286e6bfe}{codeword\_type}}) * CHAR\_BIT;}
\DoxyCodeLine{20 \textcolor{keyword}{const} \mbox{\hyperlink{direct__mapped__dict_8hh_ac1be50354aea7190e5415d85286e6bfe}{codeword\_type}} \mbox{\hyperlink{direct__mapped__dict_8hh_a1229498df19e813ea474f8c03abf969c}{MAX\_CODEWORD}} =}
\DoxyCodeLine{21     \textcolor{keyword}{static\_cast<}\mbox{\hyperlink{direct__mapped__dict_8hh_ac1be50354aea7190e5415d85286e6bfe}{codeword\_type}}\textcolor{keyword}{>}((1 << (\textcolor{keyword}{sizeof}(\mbox{\hyperlink{direct__mapped__dict_8hh_ac1be50354aea7190e5415d85286e6bfe}{codeword\_type}}) * CHAR\_BIT)) -\/ 1);}
\DoxyCodeLine{22 \textcolor{keyword}{using }\mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} = uint32\_t;}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{keyword}{class }\mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}} : \textcolor{keyword}{public} \mbox{\hyperlink{classNext__Run}{Next\_Run}}<codeword\_type> \{}
\DoxyCodeLine{25 \textcolor{keyword}{public}:}
\DoxyCodeLine{26   \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} \mbox{\hyperlink{classNext__Longest__Run_adb729d0dac9b929f99d2608108f40b99}{longest\_run\_index}};}
\DoxyCodeLine{27   \mbox{\hyperlink{classNext__Longest__Run_ab48dc050ca280cac7ed35afe42c71e76}{Next\_Longest\_Run}}(\textcolor{keywordtype}{unsigned} length, \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} cw, \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} index)}
\DoxyCodeLine{28       : \mbox{\hyperlink{classNext__Run}{Next\_Run}}<\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}}>(length, cw), \mbox{\hyperlink{classNext__Longest__Run_adb729d0dac9b929f99d2608108f40b99}{longest\_run\_index}}(index)\{\};}
\DoxyCodeLine{29   \mbox{\hyperlink{classNext__Longest__Run_a650f9274abedc111799bf922965e30f1}{Next\_Longest\_Run}}() : \mbox{\hyperlink{classNext__Run}{Next\_Run}}<\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}}>(0, 0), \mbox{\hyperlink{classNext__Longest__Run_adb729d0dac9b929f99d2608108f40b99}{longest\_run\_index}}(0)\{\};}
\DoxyCodeLine{30 \};}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{comment}{// Direct Mapped Dictionary:}}
\DoxyCodeLine{33 \textcolor{comment}{//}}
\DoxyCodeLine{34 \textcolor{comment}{// We will have dictionaries for every length 1 to MAX\_STRING\_LENGTH, for}}
\DoxyCodeLine{35 \textcolor{comment}{// strings of that length}}
\DoxyCodeLine{36 \textcolor{comment}{//}}
\DoxyCodeLine{37 \textcolor{comment}{// We will map the 4 neucleotides into two bits, so any string of length n can}}
\DoxyCodeLine{38 \textcolor{comment}{// be represented by 2n bits That 2n bit encoding is an index into the nth}}
\DoxyCodeLine{39 \textcolor{comment}{// dictionary}}
\DoxyCodeLine{40 \textcolor{comment}{//}}
\DoxyCodeLine{41 \textcolor{comment}{// in the nth dictionary, there is space for every string of length n}}
\DoxyCodeLine{42 \textcolor{comment}{//}}
\DoxyCodeLine{43 \textcolor{comment}{// upon lookup, we look at the space in the nth dictionary corresponding to the}}
\DoxyCodeLine{44 \textcolor{comment}{// 2n bit index given by our lookup string if there is a codeword there, we}}
\DoxyCodeLine{45 \textcolor{comment}{// return it. If the codeword is 0, we know we haven't seen that string before}}
\DoxyCodeLine{46 \textcolor{comment}{//}}
\DoxyCodeLine{47 \textcolor{comment}{// for strings longer than length MAX\_STRING\_LENGTH, we have a unordered\_map on}}
\DoxyCodeLine{48 \textcolor{comment}{// top to take the rest}}
\DoxyCodeLine{49 \textcolor{comment}{//}}
\DoxyCodeLine{50 \textcolor{comment}{// when we run out of codewords, we simply don't allow any more strings to be}}
\DoxyCodeLine{51 \textcolor{comment}{// added}}
\DoxyCodeLine{52 \textcolor{comment}{//}}
\DoxyCodeLine{53 \textcolor{keyword}{class }\mbox{\hyperlink{classLZW__Encode__Dictionary}{LZW\_Encode\_Dictionary}}}
\DoxyCodeLine{54     : \textcolor{keyword}{private} \mbox{\hyperlink{classLZWDictionary}{LZWDictionary}}<codeword\_type, Next\_Longest\_Run> \{}
\DoxyCodeLine{55 \textcolor{keyword}{private}:}
\DoxyCodeLine{56   \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classLZW__Encode__Dictionary_a6f46b532953561d3044ce20987f24937}{INDEX\_BITS}} = CHAR\_BIT * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}});}
\DoxyCodeLine{57   std::array<int, 1 << CHAR\_BIT> \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}};}
\DoxyCodeLine{58   \textcolor{keyword}{const} \textcolor{keywordtype}{int} \mbox{\hyperlink{classLZW__Encode__Dictionary_adaa7d145f3cca06470a99d43b29c80ec}{NEXT\_LONGEST\_INDEX\_SIZE}} = 16;}
\DoxyCodeLine{59   \textcolor{comment}{// 00000110 00000110 00000110 00000110 00000110 00000110 00000110 00000110}}
\DoxyCodeLine{60   \textcolor{keyword}{const} uint64\_t \mbox{\hyperlink{classLZW__Encode__Dictionary_a200fecd40d13648d1e4297281c01f1d4}{MASK}} = 434041037028460038;}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} \mbox{\hyperlink{classLZW__Encode__Dictionary_a9b190659c3a3811057c14dbf71a9f43d}{map\_str}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *input, \textcolor{keywordtype}{unsigned} len)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{63     \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} result = 0;}
\DoxyCodeLine{64     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} i = 0; i < len; i++) \{}
\DoxyCodeLine{65       result = (result << 2) + \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}}[input[i]];}
\DoxyCodeLine{66     \}}
\DoxyCodeLine{67     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{68   \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \textcolor{comment}{// we will map the strings directly to memory in this array}}
\DoxyCodeLine{71   std::array<std::unique\_ptr<codeword\_type[]>, \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}}> \mbox{\hyperlink{classLZW__Encode__Dictionary_a13961882ad5ec6a466f6fef598fe817b}{dictionary}};}
\DoxyCodeLine{72   \textcolor{comment}{// track when we run out of codewords}}
\DoxyCodeLine{73   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classLZW__Encode__Dictionary_a75c43349006ee712d111097b657dbc31}{empty}};}
\DoxyCodeLine{74 }
\DoxyCodeLine{75   \textcolor{comment}{// add a hashmap on top of our direct map for strings longer than our max}}
\DoxyCodeLine{76   std::unordered\_map<std::string, codeword\_type> \mbox{\hyperlink{classLZW__Encode__Dictionary_a5b36c8fe99cfca90b7808eebf16fe897}{longer\_than\_max}};}
\DoxyCodeLine{77   std::unordered\_map<std::string, codeword\_type>::const\_iterator \mbox{\hyperlink{classLZW__Encode__Dictionary_a1cb5aad43ffabb7a17a0dead889dc057}{end}};}
\DoxyCodeLine{78 }
\DoxyCodeLine{79 \textcolor{keyword}{public}:}
\DoxyCodeLine{80   \mbox{\hyperlink{classLZW__Encode__Dictionary_a627d56e0bf9ffb0798ce22e245f3ed83}{LZW\_Encode\_Dictionary}}()}
\DoxyCodeLine{81       : \mbox{\hyperlink{classLZWDictionary}{LZWDictionary}}<\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}}, \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}>(), \mbox{\hyperlink{classLZW__Encode__Dictionary_a75c43349006ee712d111097b657dbc31}{empty}}(false),}
\DoxyCodeLine{82         \mbox{\hyperlink{classLZW__Encode__Dictionary_a1cb5aad43ffabb7a17a0dead889dc057}{end}}(\mbox{\hyperlink{classLZW__Encode__Dictionary_a5b36c8fe99cfca90b7808eebf16fe897}{longer\_than\_max}}.cend()) \{}
\DoxyCodeLine{83     \textcolor{comment}{// we have an array for each possible string length < our max}}
\DoxyCodeLine{84     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}}; i++) \{}
\DoxyCodeLine{85       \textcolor{comment}{// for strings of length n, they can be represented by 2n bits}}
\DoxyCodeLine{86       \textcolor{comment}{// so 4\string^(i+1) is the number of possible strings of length i+1}}
\DoxyCodeLine{87       \textcolor{keywordtype}{int} size = pow(4, i + 1);}
\DoxyCodeLine{88       \mbox{\hyperlink{classLZW__Encode__Dictionary_a13961882ad5ec6a466f6fef598fe817b}{dictionary}}[i] = std::unique\_ptr<codeword\_type[]>(}
\DoxyCodeLine{89           (\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} *)calloc(size, \textcolor{keyword}{sizeof}(\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}})));}
\DoxyCodeLine{90       \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classLZW__Encode__Dictionary_a13961882ad5ec6a466f6fef598fe817b}{dictionary}}[i]) \{}
\DoxyCodeLine{91         std::cout << \textcolor{stringliteral}{"{}Memory Failure. Exiting...."{}} << std::endl;}
\DoxyCodeLine{92         abort();}
\DoxyCodeLine{93       \}}
\DoxyCodeLine{94     \}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96     \textcolor{comment}{// load the code values for our neucleotides}}
\DoxyCodeLine{97     \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}}[\textcolor{charliteral}{'A'}] = \mbox{\hyperlink{direct__mapped__dict_8hh_af8f9eb4fcbbe1efd8b9cd5dc2929d894}{INDEX\_OF\_A}};}
\DoxyCodeLine{98     \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}}[\textcolor{charliteral}{'C'}] = \mbox{\hyperlink{direct__mapped__dict_8hh_a766afabeccd2c5c829795a29dd11025f}{INDEX\_OF\_C}};}
\DoxyCodeLine{99     \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}}[\textcolor{charliteral}{'T'}] = \mbox{\hyperlink{direct__mapped__dict_8hh_a1ff38b8c2b87aee43fb85456a2acde5f}{INDEX\_OF\_T}};}
\DoxyCodeLine{100     \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}}[\textcolor{charliteral}{'G'}] = \mbox{\hyperlink{direct__mapped__dict_8hh_a6f11125b1391df67936cb4e5d60c4ed2}{INDEX\_OF\_G}};}
\DoxyCodeLine{101   \}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103   \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} \mbox{\hyperlink{classLZW__Encode__Dictionary_a4fc7daeb7085a96d749268441346adc6}{code\_of}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *input, \textcolor{keywordtype}{unsigned} len)\textcolor{keyword}{ const override }\{}
\DoxyCodeLine{104     \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} lookup = (\mbox{\hyperlink{classLZW__Encode__Dictionary_a13961882ad5ec6a466f6fef598fe817b}{dictionary}}[len -\/ 1])[\mbox{\hyperlink{classLZW__Encode__Dictionary_a9b190659c3a3811057c14dbf71a9f43d}{map\_str}}(input, len)];}
\DoxyCodeLine{105     \textcolor{keywordflow}{return} lookup;}
\DoxyCodeLine{106   \}}
\DoxyCodeLine{107 }
\DoxyCodeLine{108   \textcolor{comment}{// allow the caller to provide the string already mapped.}}
\DoxyCodeLine{109   \textcolor{comment}{// allows for the mapped string to be produced on the fly in some cases}}
\DoxyCodeLine{110   \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(\textcolor{keywordtype}{unsigned} len, \textcolor{keywordtype}{int} mapped\_string)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{111     \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} lookup = (\mbox{\hyperlink{classLZW__Encode__Dictionary_a13961882ad5ec6a466f6fef598fe817b}{dictionary}}[len -\/ 1])[mapped\_string];}
\DoxyCodeLine{112     \textcolor{keywordflow}{return} lookup;}
\DoxyCodeLine{113   \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115   \textcolor{comment}{// We assume that the start is already in the dictionary, and loop up from}}
\DoxyCodeLine{116   \textcolor{comment}{// there}}
\DoxyCodeLine{117   \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}} \mbox{\hyperlink{classLZW__Encode__Dictionary_aea0c443c08db9fcd96e0c76003946f35}{find\_longest\_looping\_up\_on\_fly}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *input,}
\DoxyCodeLine{118                                                   \textcolor{keyword}{const} \textcolor{keywordtype}{char} *end\_of\_input,}
\DoxyCodeLine{119                                                   \textcolor{keywordtype}{int} start, \textcolor{keywordtype}{int} index) \{}
\DoxyCodeLine{120     \textcolor{keywordtype}{int} length = start;}
\DoxyCodeLine{121     \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} entry = 0;}
\DoxyCodeLine{122     \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} last\_entry = 0;}
\DoxyCodeLine{123     \textcolor{keywordflow}{while} (input + length < end\_of\_input \&\& length < \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}}) \{}
\DoxyCodeLine{124       index = (index << 2) + \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}}[input[length]];}
\DoxyCodeLine{125       last\_entry = entry;}
\DoxyCodeLine{126       entry = \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(length + 1, index);}
\DoxyCodeLine{127       \textcolor{comment}{// if entry is non zero, it means we have seen that string before}}
\DoxyCodeLine{128       \textcolor{keywordflow}{if} (entry == 0) \{}
\DoxyCodeLine{129         \textcolor{keywordflow}{return} \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}(length, last\_entry, index >> 2);}
\DoxyCodeLine{130       \}}
\DoxyCodeLine{131       length++;}
\DoxyCodeLine{132     \}}
\DoxyCodeLine{133     \textcolor{keywordflow}{return} \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}(length, entry, index);}
\DoxyCodeLine{134   \}}
\DoxyCodeLine{135 }
\DoxyCodeLine{136   \textcolor{comment}{// We assume that the start is already in the dictionary, and loop up from}}
\DoxyCodeLine{137   \textcolor{comment}{// there}}
\DoxyCodeLine{138   \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}} \mbox{\hyperlink{classLZW__Encode__Dictionary_afb022e7797f30820d3556862a2b86bdf}{find\_longest\_looping\_up}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *input,}
\DoxyCodeLine{139                                            \textcolor{keyword}{const} \textcolor{keywordtype}{char} *end\_of\_input, \textcolor{keywordtype}{int} start,}
\DoxyCodeLine{140                                            \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} index) \{}
\DoxyCodeLine{141     \textcolor{keywordtype}{int} length = start;}
\DoxyCodeLine{142     \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} entry = 0;}
\DoxyCodeLine{143     \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} last\_entry = 0;}
\DoxyCodeLine{144     \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} next\_index = 0;}
\DoxyCodeLine{145     \textcolor{keywordflow}{while} (input + length < end\_of\_input \&\& length < \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}}) \{}
\DoxyCodeLine{146       next\_index = (index >> (\mbox{\hyperlink{classLZW__Encode__Dictionary_a6f46b532953561d3044ce20987f24937}{INDEX\_BITS}} -\/ (length + 1) * 2));}
\DoxyCodeLine{147       last\_entry = entry;}
\DoxyCodeLine{148       entry = \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(length + 1, next\_index);}
\DoxyCodeLine{149       \textcolor{comment}{// if entry is non zero, it means we have seen that string before}}
\DoxyCodeLine{150       \textcolor{keywordflow}{if} (entry == 0) \{}
\DoxyCodeLine{151         \textcolor{keywordflow}{return} \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}(length, last\_entry, next\_index >> 2);}
\DoxyCodeLine{152       \}}
\DoxyCodeLine{153       length++;}
\DoxyCodeLine{154     \}}
\DoxyCodeLine{155     \textcolor{keywordflow}{return} \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}(length, entry, next\_index);}
\DoxyCodeLine{156   \}}
\DoxyCodeLine{157 }
\DoxyCodeLine{158   \textcolor{comment}{// Assumes we already have the starting characters in the dictionary}}
\DoxyCodeLine{159   \textcolor{comment}{// should never return 0}}
\DoxyCodeLine{160   \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}} \mbox{\hyperlink{classLZW__Encode__Dictionary_aca60686d1874db378a0bc026307447a6}{find\_longest\_looping\_down}}(\textcolor{keywordtype}{int} start, \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} index) \{}
\DoxyCodeLine{161     \textcolor{keywordtype}{int} length = start;}
\DoxyCodeLine{162     \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} entry;}
\DoxyCodeLine{163     \textcolor{keywordflow}{while} (length > 0) \{}
\DoxyCodeLine{164       entry = \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(length, index);}
\DoxyCodeLine{165       \textcolor{comment}{// if entry is non zero, it means we have seen that string before}}
\DoxyCodeLine{166       \textcolor{keywordflow}{if} (entry != 0) \{}
\DoxyCodeLine{167         \textcolor{keywordflow}{return} \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}(length, entry, index);}
\DoxyCodeLine{168       \}}
\DoxyCodeLine{169       length-\/-\/;}
\DoxyCodeLine{170       index = (index >> 2);}
\DoxyCodeLine{171     \}}
\DoxyCodeLine{172     \textcolor{keywordflow}{return} \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}(length, entry, index);}
\DoxyCodeLine{173   \}}
\DoxyCodeLine{174 }
\DoxyCodeLine{175   \textcolor{comment}{// find longest using binary search.}}
\DoxyCodeLine{176   \textcolor{comment}{// assumes that the longest run < max}}
\DoxyCodeLine{177   \textcolor{comment}{// assumes that all characters are in starting dictionary}}
\DoxyCodeLine{178   \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}} \mbox{\hyperlink{classLZW__Encode__Dictionary_a2b0317fc6fd9e266f9be606b3136447f}{find\_longest\_binary\_search}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *input, \textcolor{keywordtype}{int} left,}
\DoxyCodeLine{179                                               \textcolor{keywordtype}{int} right,}
\DoxyCodeLine{180                                               \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} full\_index) \{}
\DoxyCodeLine{181     \textcolor{keywordtype}{int} middle = left + ((right -\/ left) / 2);}
\DoxyCodeLine{182     \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} entry;}
\DoxyCodeLine{183     \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} index;}
\DoxyCodeLine{184     \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} next\_index;}
\DoxyCodeLine{185     \textcolor{keywordflow}{while} (left <= right) \{}
\DoxyCodeLine{186       next\_index = full\_index >> (\mbox{\hyperlink{classLZW__Encode__Dictionary_a6f46b532953561d3044ce20987f24937}{INDEX\_BITS}} -\/ (middle + 1) * 2);}
\DoxyCodeLine{187       index = next\_index >> 2;}
\DoxyCodeLine{188       entry = \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(middle, index);}
\DoxyCodeLine{189       \textcolor{keywordflow}{if} (entry == 0) \{}
\DoxyCodeLine{190         right = middle -\/ 1;}
\DoxyCodeLine{191         middle = left + ((right -\/ left) / 2);}
\DoxyCodeLine{192       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (middle == \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}} ||}
\DoxyCodeLine{193                  \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(middle + 1, next\_index) == 0) \{}
\DoxyCodeLine{194         \textcolor{keywordflow}{return} \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}(middle, entry, index);}
\DoxyCodeLine{195       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{196         left = middle + 1;}
\DoxyCodeLine{197         middle = left + ((right -\/ left) / 2);}
\DoxyCodeLine{198       \}}
\DoxyCodeLine{199     \}}
\DoxyCodeLine{200 }
\DoxyCodeLine{201     index = \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}}[input[0]];}
\DoxyCodeLine{202     entry = \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(1, index);}
\DoxyCodeLine{203     \textcolor{keywordflow}{return} \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}}(1, entry, index);}
\DoxyCodeLine{204   \}}
\DoxyCodeLine{205 }
\DoxyCodeLine{206   \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}} \mbox{\hyperlink{classLZW__Encode__Dictionary_a2d7518c3147f6c1102ef84c7aeed0e8c}{find\_longest\_in\_dict}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *input,}
\DoxyCodeLine{207                                         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *end\_of\_input)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{208 }
\DoxyCodeLine{209     \textcolor{comment}{// start at start and loop up or down}}
\DoxyCodeLine{210     \textcolor{keywordflow}{if} (input + 16 > end\_of\_input) \{}
\DoxyCodeLine{211       \textcolor{keywordflow}{return} \mbox{\hyperlink{classLZW__Encode__Dictionary_aea0c443c08db9fcd96e0c76003946f35}{find\_longest\_looping\_up\_on\_fly}}(input, end\_of\_input, 0, 0);}
\DoxyCodeLine{212     \}}
\DoxyCodeLine{213 }
\DoxyCodeLine{214     \textcolor{keyword}{const} uint64\_t *input\_ints = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }uint64\_t *\textcolor{keyword}{>}(input);}
\DoxyCodeLine{215     uint64\_t swapped = \_bswap64(input\_ints[0]);}
\DoxyCodeLine{216     uint64\_t swapped2 = \_bswap64(input\_ints[1]);}
\DoxyCodeLine{217     uint64\_t first\_half = \_pext\_u64(swapped, \mbox{\hyperlink{classLZW__Encode__Dictionary_a200fecd40d13648d1e4297281c01f1d4}{MASK}});}
\DoxyCodeLine{218     uint64\_t second\_half = \_pext\_u64(swapped2, \mbox{\hyperlink{classLZW__Encode__Dictionary_a200fecd40d13648d1e4297281c01f1d4}{MASK}});}
\DoxyCodeLine{219     \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} next\_long\_index =}
\DoxyCodeLine{220         (first\_half << \mbox{\hyperlink{classLZW__Encode__Dictionary_adaa7d145f3cca06470a99d43b29c80ec}{NEXT\_LONGEST\_INDEX\_SIZE}}) + second\_half;}
\DoxyCodeLine{221 }
\DoxyCodeLine{222 }
\DoxyCodeLine{223     \textcolor{keywordflow}{if}(!\mbox{\hyperlink{direct__mapped__dict_8hh_a41eb8ff724e2179b96c314a1fbd010d2}{BINARY\_SEARCH}})\{}
\DoxyCodeLine{224     \textcolor{comment}{// check the starting length}}
\DoxyCodeLine{225      \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} index\_for\_fl\_start = next\_long\_index >>}
\DoxyCodeLine{226       (\mbox{\hyperlink{classLZW__Encode__Dictionary_a6f46b532953561d3044ce20987f24937}{INDEX\_BITS}}-\/(\mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}}*2)); }
\DoxyCodeLine{227     \textcolor{keywordtype}{int} entry = \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(\mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}}, index\_for\_fl\_start);}
\DoxyCodeLine{228     \textcolor{keywordflow}{if}(entry == 0)\{}
\DoxyCodeLine{229         \textcolor{keywordflow}{return} \mbox{\hyperlink{classLZW__Encode__Dictionary_aca60686d1874db378a0bc026307447a6}{find\_longest\_looping\_down}}(\mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}},}
\DoxyCodeLine{230       index\_for\_fl\_start); }
\DoxyCodeLine{231      \} }
\DoxyCodeLine{232      \textcolor{keywordflow}{return} \mbox{\hyperlink{classLZW__Encode__Dictionary_afb022e7797f30820d3556862a2b86bdf}{find\_longest\_looping\_up}}(input, end\_of\_input, \mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}}-\/1,}
\DoxyCodeLine{233       next\_long\_index); }
\DoxyCodeLine{234 }
\DoxyCodeLine{235     \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{236 }
\DoxyCodeLine{237     \textcolor{comment}{// start at start and binary search}}
\DoxyCodeLine{238     \textcolor{comment}{// check the starting string}}
\DoxyCodeLine{239     \textcolor{keywordtype}{int} index = next\_long\_index >> (\mbox{\hyperlink{classLZW__Encode__Dictionary_a6f46b532953561d3044ce20987f24937}{INDEX\_BITS}} -\/ \mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}} * 2);}
\DoxyCodeLine{240     \textcolor{keywordtype}{int} entry = \mbox{\hyperlink{classLZW__Encode__Dictionary_a6e44171eabb4fb3db1a53045ac30ba35}{code\_of\_manual}}(\mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}}, index);}
\DoxyCodeLine{241     \textcolor{keywordflow}{if} (entry == 0) \{}
\DoxyCodeLine{242       \textcolor{keywordflow}{return} \mbox{\hyperlink{classLZW__Encode__Dictionary_a2b0317fc6fd9e266f9be606b3136447f}{find\_longest\_binary\_search}}(input, 1, \mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}} -\/ 1,}
\DoxyCodeLine{243                                         next\_long\_index);}
\DoxyCodeLine{244     \}}
\DoxyCodeLine{245     \textcolor{keywordflow}{return} \mbox{\hyperlink{classLZW__Encode__Dictionary_a2b0317fc6fd9e266f9be606b3136447f}{find\_longest\_binary\_search}}(input, \mbox{\hyperlink{direct__mapped__dict_8hh_aabe57523e3a6008fd8421a152675a879}{FIND\_LONGEST\_START}},}
\DoxyCodeLine{246                                       \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}}, next\_long\_index);}
\DoxyCodeLine{247 }
\DoxyCodeLine{248     \}}
\DoxyCodeLine{249   \}}
\DoxyCodeLine{250 }
\DoxyCodeLine{251   \textcolor{keywordtype}{void} \mbox{\hyperlink{classLZW__Encode__Dictionary_a6be8783bfcd1b9b910b9224ea61f2238}{add\_string}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *input, \textcolor{keywordtype}{unsigned} len,}
\DoxyCodeLine{252                   \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} codeword)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{253     \textcolor{comment}{// we want to prevent collisions, so when we reached our limit,}}
\DoxyCodeLine{254     \textcolor{comment}{// allow this last addition then declare the dict empty.}}
\DoxyCodeLine{255     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classLZW__Encode__Dictionary_a75c43349006ee712d111097b657dbc31}{empty}}) \{}
\DoxyCodeLine{256       \textcolor{keywordflow}{return};}
\DoxyCodeLine{257     \}}
\DoxyCodeLine{258     \textcolor{keywordflow}{if} (codeword == \mbox{\hyperlink{std__dict_8hh_a1229498df19e813ea474f8c03abf969c}{MAX\_CODEWORD}}) \{}
\DoxyCodeLine{259       \mbox{\hyperlink{classLZW__Encode__Dictionary_a75c43349006ee712d111097b657dbc31}{empty}} = \textcolor{keyword}{true};}
\DoxyCodeLine{260     \}}
\DoxyCodeLine{261 }
\DoxyCodeLine{262     \textcolor{comment}{// we just don't add anything longer to the dict}}
\DoxyCodeLine{263     \textcolor{keywordflow}{if} (len > \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}}) \{}
\DoxyCodeLine{264       \textcolor{keywordflow}{return};}
\DoxyCodeLine{265     \}}
\DoxyCodeLine{266     (\mbox{\hyperlink{classLZW__Encode__Dictionary_a13961882ad5ec6a466f6fef598fe817b}{dictionary}}[len -\/ 1])[\mbox{\hyperlink{classLZW__Encode__Dictionary_a9b190659c3a3811057c14dbf71a9f43d}{map\_str}}(input, len)] = codeword;}
\DoxyCodeLine{267   \}}
\DoxyCodeLine{268 }
\DoxyCodeLine{269   \textcolor{keywordtype}{void} \mbox{\hyperlink{classLZW__Encode__Dictionary_acccdd096e9a075396618d2376864068c}{add\_string}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *input, \mbox{\hyperlink{classNext__Longest__Run}{Next\_Longest\_Run}} next\_longest,}
\DoxyCodeLine{270                   \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} codeword)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{271     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classLZW__Encode__Dictionary_a75c43349006ee712d111097b657dbc31}{empty}}) \{}
\DoxyCodeLine{272       \textcolor{keywordflow}{return};}
\DoxyCodeLine{273     \}}
\DoxyCodeLine{274     \textcolor{keywordflow}{if} (codeword == \mbox{\hyperlink{std__dict_8hh_a1229498df19e813ea474f8c03abf969c}{MAX\_CODEWORD}}) \{}
\DoxyCodeLine{275       \mbox{\hyperlink{classLZW__Encode__Dictionary_a75c43349006ee712d111097b657dbc31}{empty}} = \textcolor{keyword}{true};}
\DoxyCodeLine{276     \}}
\DoxyCodeLine{277     \textcolor{comment}{// we just don't add anything longer to the dict}}
\DoxyCodeLine{278     \textcolor{keywordflow}{if} (next\_longest.\mbox{\hyperlink{classNext__Run_af472c19f2f4422b0c14b219624a497d8}{next\_run\_length}} + 1 > \mbox{\hyperlink{direct__mapped__dict_8hh_a7bd1acc5b4c38c0084ae1f99aa7c2b0d}{MAX\_STRING\_LENGTH}}) \{}
\DoxyCodeLine{279       \textcolor{keywordflow}{return};}
\DoxyCodeLine{280     \}}
\DoxyCodeLine{281     \mbox{\hyperlink{direct__mapped__dict_8hh_a2e340426945fbac9d43dda2eba3e49ac}{index\_type}} index = (next\_longest.\mbox{\hyperlink{classNext__Longest__Run_adb729d0dac9b929f99d2608108f40b99}{longest\_run\_index}} << 2) +}
\DoxyCodeLine{282                        \mbox{\hyperlink{classLZW__Encode__Dictionary_a3ed2e0e5fe89cbe1b4ff4d6a62dac503}{values}}[input[next\_longest.\mbox{\hyperlink{classNext__Run_af472c19f2f4422b0c14b219624a497d8}{next\_run\_length}}]];}
\DoxyCodeLine{283     (\mbox{\hyperlink{classLZW__Encode__Dictionary_a13961882ad5ec6a466f6fef598fe817b}{dictionary}}[next\_longest.\mbox{\hyperlink{classNext__Run_af472c19f2f4422b0c14b219624a497d8}{next\_run\_length}}])[index] = codeword;}
\DoxyCodeLine{284   \}}
\DoxyCodeLine{285   \textcolor{keywordtype}{void} \mbox{\hyperlink{classLZW__Encode__Dictionary_a5444ca2ad02971afcae4e04955c957b3}{load\_starting\_dictionary}}()\textcolor{keyword}{ override }\{}
\DoxyCodeLine{286     \mbox{\hyperlink{classLZW__Encode__Dictionary_a6be8783bfcd1b9b910b9224ea61f2238}{add\_string}}(\textcolor{stringliteral}{"{}A"{}}, 1, 1);}
\DoxyCodeLine{287     \mbox{\hyperlink{classLZW__Encode__Dictionary_a6be8783bfcd1b9b910b9224ea61f2238}{add\_string}}(\textcolor{stringliteral}{"{}C"{}}, 1, 2);}
\DoxyCodeLine{288     \mbox{\hyperlink{classLZW__Encode__Dictionary_a6be8783bfcd1b9b910b9224ea61f2238}{add\_string}}(\textcolor{stringliteral}{"{}T"{}}, 1, 3);}
\DoxyCodeLine{289     \mbox{\hyperlink{classLZW__Encode__Dictionary_a6be8783bfcd1b9b910b9224ea61f2238}{add\_string}}(\textcolor{stringliteral}{"{}G"{}}, 1, 4);}
\DoxyCodeLine{290   \}}
\DoxyCodeLine{291 \};}
\DoxyCodeLine{292 }
\DoxyCodeLine{293 \textcolor{comment}{// Direct Decode}}
\DoxyCodeLine{294 \textcolor{comment}{//}}
\DoxyCodeLine{295 \textcolor{comment}{// we simply have an array of strings long enough to accomodate every codeword.}}
\DoxyCodeLine{296 \textcolor{comment}{//}}
\DoxyCodeLine{297 \textcolor{comment}{// codewords index into the dictionary, and adding and searching are trivial}}
\DoxyCodeLine{298 \textcolor{comment}{// from that fact}}
\DoxyCodeLine{299 \textcolor{keyword}{class }\mbox{\hyperlink{classLZW__Decode__Dictionary}{LZW\_Decode\_Dictionary}} : \textcolor{keyword}{private} \mbox{\hyperlink{classLZWDictionary}{LZWDictionary}}<codeword\_type> \{}
\DoxyCodeLine{300 \textcolor{keyword}{private}:}
\DoxyCodeLine{301   \textcolor{keyword}{static} \textcolor{keyword}{constexpr} \textcolor{keywordtype}{int} \mbox{\hyperlink{classLZW__Decode__Dictionary_a6d85ff2b01c442a9be37ea70a9f58e06}{CODEWORD\_SIZE}} = CHAR\_BIT * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}});}
\DoxyCodeLine{302   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classLZW__Decode__Dictionary_a7ab9a4a4fa6d7ef81cc5ad03c0065f7a}{empty}};}
\DoxyCodeLine{303 }
\DoxyCodeLine{304 \textcolor{keyword}{public}:}
\DoxyCodeLine{305   std::array<std::string, MAX\_CODEWORD + 1> \mbox{\hyperlink{classLZW__Decode__Dictionary_a599c3f32e2d9e0647490a4d339c8aedb}{dictionary}};}
\DoxyCodeLine{306   \mbox{\hyperlink{classLZW__Decode__Dictionary_a7561e81d9a2a96b79e35ef27e5b515fd}{LZW\_Decode\_Dictionary}}() : \mbox{\hyperlink{classLZWDictionary}{LZWDictionary}}<\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}}>(), \mbox{\hyperlink{classLZW__Decode__Dictionary_a7ab9a4a4fa6d7ef81cc5ad03c0065f7a}{empty}}(false) \{\}}
\DoxyCodeLine{307 }
\DoxyCodeLine{308   \textcolor{keywordtype}{void} \mbox{\hyperlink{classLZW__Decode__Dictionary_a4f421d36b3c2c507dc9e7657934d95e4}{add\_string}}(std::string str, \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} codeword)\textcolor{keyword}{ override }\{}
\DoxyCodeLine{309     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classLZW__Decode__Dictionary_a7ab9a4a4fa6d7ef81cc5ad03c0065f7a}{empty}}) \{}
\DoxyCodeLine{310       \textcolor{keywordflow}{return};}
\DoxyCodeLine{311     \}}
\DoxyCodeLine{312     \textcolor{keywordflow}{if} (codeword == \mbox{\hyperlink{std__dict_8hh_a1229498df19e813ea474f8c03abf969c}{MAX\_CODEWORD}}) \{}
\DoxyCodeLine{313       \mbox{\hyperlink{classLZW__Decode__Dictionary_a7ab9a4a4fa6d7ef81cc5ad03c0065f7a}{empty}} = \textcolor{keyword}{true};}
\DoxyCodeLine{314     \}}
\DoxyCodeLine{315     \mbox{\hyperlink{classLZW__Decode__Dictionary_a599c3f32e2d9e0647490a4d339c8aedb}{dictionary}}[codeword] = str;}
\DoxyCodeLine{316   \}}
\DoxyCodeLine{317 }
\DoxyCodeLine{318   std::string \mbox{\hyperlink{classLZW__Decode__Dictionary_a5dacfe306ace6d46d38ad2c9e904311a}{str\_of}}(\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} codeword)\textcolor{keyword}{ const override }\{}
\DoxyCodeLine{319     \textcolor{keywordflow}{return} \mbox{\hyperlink{classLZW__Decode__Dictionary_a599c3f32e2d9e0647490a4d339c8aedb}{dictionary}}[codeword];}
\DoxyCodeLine{320   \}}
\DoxyCodeLine{321 }
\DoxyCodeLine{322   \textcolor{keywordtype}{void} \mbox{\hyperlink{classLZW__Decode__Dictionary_acd30119cddb1f2ac910044cdabd72036}{load\_starting\_dictionary}}()\textcolor{keyword}{ override }\{}
\DoxyCodeLine{323     \mbox{\hyperlink{classLZW__Decode__Dictionary_a4f421d36b3c2c507dc9e7657934d95e4}{add\_string}}(\textcolor{stringliteral}{"{}A"{}}, 1);}
\DoxyCodeLine{324     \mbox{\hyperlink{classLZW__Decode__Dictionary_a4f421d36b3c2c507dc9e7657934d95e4}{add\_string}}(\textcolor{stringliteral}{"{}C"{}}, 2);}
\DoxyCodeLine{325     \mbox{\hyperlink{classLZW__Decode__Dictionary_a4f421d36b3c2c507dc9e7657934d95e4}{add\_string}}(\textcolor{stringliteral}{"{}T"{}}, 3);}
\DoxyCodeLine{326     \mbox{\hyperlink{classLZW__Decode__Dictionary_a4f421d36b3c2c507dc9e7657934d95e4}{add\_string}}(\textcolor{stringliteral}{"{}G"{}}, 4);}
\DoxyCodeLine{327   \}}
\DoxyCodeLine{328 \};}
\DoxyCodeLine{329 }
\DoxyCodeLine{330 \textcolor{comment}{// Codeword\_Helper for Direct Map:}}
\DoxyCodeLine{331 \textcolor{comment}{//}}
\DoxyCodeLine{332 \textcolor{comment}{// Since we have fixed length codeword, we only worry about overflow and}}
\DoxyCodeLine{333 \textcolor{comment}{// incrementing the codeword}}
\DoxyCodeLine{334 \textcolor{comment}{//}}
\DoxyCodeLine{335 \textcolor{keyword}{class }\mbox{\hyperlink{classCodeword__Helper}{Codeword\_Helper}} : \textcolor{keyword}{public} \mbox{\hyperlink{classCW__Tracker}{CW\_Tracker}}<codeword\_type> \{}
\DoxyCodeLine{336 }
\DoxyCodeLine{337 \textcolor{keyword}{public}:}
\DoxyCodeLine{338   \mbox{\hyperlink{classCodeword__Helper_ab2394cc2982b73b74723c1a1fb0f2d1e}{Codeword\_Helper}}()}
\DoxyCodeLine{339       : \mbox{\hyperlink{classCW__Tracker}{CW\_Tracker}}<\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}}>(6, 5, sizeof(\mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}}) * CHAR\_BIT)\{\};}
\DoxyCodeLine{340   \mbox{\hyperlink{std__dict_8hh_ab7f8a9108b264c05ed4f7a78ebb5e559}{codeword\_type}} \mbox{\hyperlink{classCodeword__Helper_a3a27fd7969bf07ee1c5cf004b48c3011}{get\_next\_codeword}}() \{}
\DoxyCodeLine{341     \textcolor{keywordflow}{if} (\mbox{\hyperlink{classCW__Tracker_a00e5f60f23844c82b356dbac5160d09b}{current\_codeword}} == \mbox{\hyperlink{std__dict_8hh_a1229498df19e813ea474f8c03abf969c}{MAX\_CODEWORD}}) \{}
\DoxyCodeLine{342       \textcolor{keywordflow}{return} \mbox{\hyperlink{std__dict_8hh_a1229498df19e813ea474f8c03abf969c}{MAX\_CODEWORD}};}
\DoxyCodeLine{343     \}}
\DoxyCodeLine{344     \textcolor{keywordflow}{return} \mbox{\hyperlink{classCW__Tracker_a00e5f60f23844c82b356dbac5160d09b}{current\_codeword}}++;}
\DoxyCodeLine{345   \}}
\DoxyCodeLine{346 \};}

\end{DoxyCode}
